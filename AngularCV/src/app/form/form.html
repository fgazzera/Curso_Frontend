<div class="container">
  <section class="contact-card" aria-labelledby="contact-title">
    <div class="contact-card__header">
      <h2 id="contact-title">Contacto</h2>
      <p>Completá el formulario y nos pondremos en contacto a la brevedad.</p>
    </div>

    @if (submitted()) {
      <aside class="contact-card__feedback" role="status">
        <strong>¡Gracias por escribirnos!</strong>
        <p>Guardamos tus datos y pronto vamos a responder tu mensaje.</p>
      </aside>
    }

    <form [formGroup]="contactForm" (ngSubmit)="submit()" novalidate>
      <div class="field">
        <label for="fullName">Nombre completo *</label>
        <input
          id="fullName"
          type="text"
          formControlName="fullName"
          autocomplete="name"
          placeholder="Ej: Ada Lovelace"
        />
        @if (showError('fullName', 'required')) {
          <small class="field__error">El nombre es obligatorio.</small>
        }
        @if (showError('fullName', 'minlength')) {
          <small class="field__error">Ingresá al menos 3 caracteres.</small>
        }
      </div>

      <div class="field">
        <label for="email">Correo electrónico *</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          autocomplete="email"
          placeholder="nombre@correo.com"
        />
        @if (showError('email', 'required')) {
          <small class="field__error">El correo es obligatorio.</small>
        }
        @if (showError('email', 'email')) {
          <small class="field__error">Ingresá un correo válido.</small>
        }
      </div>

      <div class="field">
        <label for="reason">Motivo *</label>
        <select id="reason" formControlName="reason">
          <option value="">Elegí una opción</option>
          @for (reason of reasons(); track reason.value) {
            <option [value]="reason.value">{{ reason.label }}</option>
          }
        </select>
        @if (showError('reason', 'required')) {
          <small class="field__error">Seleccioná un motivo.</small>
        }
      </div>

      <div class="field">
        <label for="message">Mensaje *</label>
        <textarea
          id="message"
          formControlName="message"
          rows="4"
          placeholder="Contanos en qué podemos ayudarte"
        ></textarea>
        @if (showError('message', 'required')) {
          <small class="field__error">El mensaje es obligatorio.</small>
        }
        @if (showError('message', 'minlength')) {
          <small class="field__error">El mensaje debe tener al menos 10 caracteres.</small>
        }
      </div>

      <div class="field field--checkbox">
        <input type="checkbox" id="privacy" formControlName="privacy" />
        <label for="privacy">Acepto la política de privacidad *</label>
        @if (showError('privacy', 'required')) {
          <small class="field__error">Necesitamos tu consentimiento.</small>
        }
      </div>

      <div class="field field--checkbox">
        <input type="checkbox" id="subscribe" formControlName="subscribe" />
        <label for="subscribe">Quiero recibir novedades y aprendizajes del proyecto</label>
      </div>

      <div class="form-actions">
        <button class="btn btn--ghost" type="button" (click)="reset()">Limpiar</button>
        <button class="btn" type="submit">Enviar</button>
      </div>
    </form>

    @if (lastSubmission()) {
      <div class="contact-card__preview" aria-live="polite">
        <h3>Resumen del envío</h3>
        <ul>
          <li><span>Nombre:</span> {{ lastSubmission()!.fullName }}</li>
          <li><span>Correo:</span> {{ lastSubmission()!.email }}</li>
          <li><span>Motivo:</span> {{ reasonLabelFor(lastSubmission()!.reason) }}</li>
          <li><span>Mensaje:</span> {{ lastSubmission()!.message }}</li>
        </ul>
      </div>
    }
  </section>
</div>
